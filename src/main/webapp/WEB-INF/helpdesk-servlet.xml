<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
       http://www.springframework.org/schema/oxm http://www.springframework.org/schema/oxm/spring-oxm-3.0.xsd">
    
    <context:component-scan base-package="de.berlios.jhelpdesk"/>

    <tx:annotation-driven />
    
    <!-- mapowanie kontrolerÃ³w -->
    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/>
    
    <!--  inne beany widoku -->
    <bean id="messageSource"
		class="org.springframework.context.support.ResourceBundleMessageSource">
        <property name="basename">
            <value>message</value>
        </property>
    </bean>

    <bean id="tilesConfigurator"
        class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
        <property name="preparerFactoryClass"
			value="org.springframework.web.servlet.view.tiles2.SpringBeanPreparerFactory" />
        <property name="definitions">
            <value>/WEB-INF/tiles-config.xml</value>
        </property>
    </bean>

    <bean id="jspViewResolver"
        class="org.springframework.web.servlet.view.UrlBasedViewResolver">
        <property name="viewClass">
            <value>org.springframework.web.servlet.view.tiles2.TilesView</value>
        </property>
        <property name="requestContextAttribute">
            <value>rc</value>
        </property>
    </bean>

    <bean id="multipartResolver"
        class="org.springframework.web.multipart.commons.CommonsMultipartResolver"/>

	<!--
    // widoki  formacie PDF chwilowo nieczynne
    <bean
		id="pdfViewResolver"
		class="org.springframework.web.servlet.view.XmlViewResolver">
        <property name="order">
            <value>1</value>
        </property>
        <property name="location" value="/WEB-INF/views.xml"/>
    </bean>
	-->

    <!-- @Deprecated -->
    <bean id="ticketsNotifiedByMeViewController"
		class="de.berlios.jhelpdesk.web.ticket.TicketsNotifiedByMeViewController"
		scope="prototype">
        <property name="commandName">
            <value>filterForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowTicketsNotifiedByMeFilterForm</value>
        </property>
        <property name="formView">
            <value>ticketsNotifiedByMeList</value>
        </property>
        <property name="successView">
            <value>ticketsNotifiedByMeList.html</value>
        </property>
    </bean>

    <!-- @Deprecated -->
    <bean id="ticketsAssignedToMeViewController"
		class="de.berlios.jhelpdesk.web.ticket.TicketsAssignedToMeViewController"
		scope="prototype">
        <property name="commandName">
            <value>filterForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowTicketsAssignedToMeFilterForm</value>
        </property>
        <property name="formView">
            <value>ticketsAssignedToMeList</value>
        </property>
		<!--<property name="successView"><value>showNewTickets.html</value></property>-->
    </bean>

    <!-- @Deprecated -->
    <bean id="killerNewTicketsViewController"
		class="de.berlios.jhelpdesk.web.ticket.TicketsNewViewController" 
		scope="prototype">
        <property name="commandName">
            <value>filterForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowTicketsNewFilterForm</value>
        </property>
        <property name="formView">
            <value>ticketsNewList</value>
        </property>
		<!--<property name="successView"><value>showNewTickets.html</value></property>-->
    </bean>
	
    <bean id="killerTicketsViewController"
		class="de.berlios.jhelpdesk.web.ticket.TicketsViewController" 
		scope="prototype">
        <property name="commandName">
            <value>filterForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowTicketsFilterForm</value>
        </property>
        <property name="formView">
            <value>ticketsList</value>
        </property>
		<!--<property name="successView"><value>showTickets.html</value></property>-->
    </bean>
    
    <bean id="killerTicketEditController"
        class="de.berlios.jhelpdesk.web.ticket.TicketWizardFormController">
        <property name="commandName">
            <value>hdticket</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.model.Ticket</value>
        </property>
        <property name="pages">
            <list>
                <value>ticketWizard/step1</value>
                <value>ticketWizard/step2</value>
                <value>ticketWizard/step3</value>
                <value>ticketWizard/step4</value>
                <value>ticketWizard/summary</value>
            </list>
        </property>
        <property name="fileRepositoryPath">
            <value type="java.lang.String">c:\\helpdesk\\files\\</value>
        </property>
    </bean>

    <bean id="urlMapping"
        class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
				<!-- akcje zwiazane z bledami -->
                <prop key="/showTickets.html">killerTicketsViewController</prop>
                <prop key="/showNewTickets.html">killerNewTicketsViewController</prop>
                <prop key="/showTicketsNotifiedByMe.html">ticketsNotifiedByMeViewController</prop>
                <prop key="/showTicketsAssignedToMe.html">ticketsAssignedToMeViewController</prop>
                <prop key="/newTicket.html">killerTicketEditController</prop>
            </props>
        </property>
    </bean>
</beans>