<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
            http://www.springframework.org/schema/oxm http://www.springframework.org/schema/oxm/spring-oxm-3.0.xsd">
    
    <context:component-scan base-package="de.berlios.jhelpdesk"/>

    <bean id="loginController" class="de.berlios.jhelpdesk.web.LoginController" scope="prototype">
        <property name="commandName">
            <value>loginForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.UserLoginForm</value>
        </property>
        <property name="formView">
            <value>login</value>
        </property>
        <property name="successView">
            <value>/desktop/main.html</value>
        </property>
    </bean>

    <bean
		id="bugsNotifiedByMeViewController"
		class="de.berlios.jhelpdesk.web.bugkiller.BugsNotifiedByMeViewController"
		scope="prototype">
        <property name="commandName">
            <value>filterForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowBugsNotifiedByMeFilterForm</value>
        </property>
        <property name="formView">
            <value>bugsNotifiedByMeList</value>
        </property>
        <property name="successView">
            <value>bugsNotifiedByMeList.html</value>
        </property>
    </bean>
	
    <bean
		id="bugsAssignedToMeViewController"
		class="de.berlios.jhelpdesk.web.bugkiller.BugsAssignedToMeViewController"
		scope="prototype">
        <property name="commandName">
            <value>filterForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowBugsAssignedToMeFilterForm</value>
        </property>
        <property name="formView">
            <value>bugsAssignedToMeList</value>
        </property>
		<!--<property name="successView"><value>showNewBugs.html</value></property>-->
    </bean>
	
    <bean
		id="bugsNonresolvedAssignedToMeViewController"
		class="de.berlios.jhelpdesk.web.bugkiller.BugsNonresolvedAssignedToMeViewController"
		scope="prototype">
        <property name="formView">
            <value>bugsNonresolvedAssignedToMeList</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowBugsNonresolvedAssignedToMeFilterForm</value>
        </property>
    </bean>
	
    <bean
		id="bugsNonresolvedViewController"
		class="de.berlios.jhelpdesk.web.bugkiller.BugsNonresolvedViewController"
		scope="prototype">
        <property name="formView">
            <value>bugsNonresolvedList</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowBugsNonresolvedFilterForm</value>
        </property>
    </bean>
	
    <bean
		id="killerNewBugsViewController" 
		class="de.berlios.jhelpdesk.web.bugkiller.BugsNewViewController" 
		scope="prototype">
        <property name="commandName">
            <value>filterForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowBugsNewFilterForm</value>
        </property>
        <property name="formView">
            <value>bugsNewList</value>
        </property>
		<!--<property name="successView"><value>showNewBugs.html</value></property>-->
    </bean>
	
    <bean
		id="killerBugsViewController" 
		class="de.berlios.jhelpdesk.web.bugkiller.BugsViewController" 
		scope="prototype">
        <property name="commandName">
            <value>filterForm</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.ShowBugsFilterForm</value>
        </property>
        <property name="formView">
            <value>bugsList</value>
        </property>
		<!--<property name="successView"><value>showBugs.html</value></property>-->
    </bean>

    <bean id="killerBugViewController" class="de.berlios.jhelpdesk.web.bugkiller.BugViewController" scope="prototype">
        <property name="fileRepositoryPath">
            <value type="java.lang.String">c:\\helpdesk\\files\\</value>
        </property>
    </bean>
	
    <bean id="killerBugEditController" class="de.berlios.jhelpdesk.web.bugkiller.BugWizardFormController" scope="prototype">
        <property name="commandName">
            <value>hdbug</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.model.Bug</value>
        </property>
        <property name="pages">
            <list>
                <value>bugWizard/step1</value>
                <value>bugWizard/step2</value>
                <value>bugWizard/step3</value>
                <value>bugWizard/step4</value>
                <value>bugWizard/summary</value>
            </list>
        </property>
        <property name="fileRepositoryPath">
            <value type="java.lang.String">c:\\helpdesk\\files\\</value>
        </property>
    </bean>
	
	<!-- preferences -->
    <bean
		id="preferencesLookAndFeelCtrl"
		class="de.berlios.jhelpdesk.web.preferences.LookAndFeelEditController" scope="prototype">
        <property name="commandName">
            <value>preferences</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.LookAndFeelForm</value>
        </property>
        <property name="formView">
            <value>preferences/lookAndFeel</value>
        </property>
        <property name="successView">
            <value>preferences/lookAndFeel</value>
        </property>
    </bean>
	
    <bean
		id="preferencesDisplayListsCtrl"
		class="de.berlios.jhelpdesk.web.preferences.DisplayListsEditController" scope="prototype">
        <property name="commandName">
            <value>preferences</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.DisplayListsForm</value>
        </property>
        <property name="formView">
            <value>preferences/displayLists</value>
        </property>
        <property name="successView">
            <value>preferences/displayLists</value>
        </property>
    </bean>
	
    <bean
		id="preferencesEventNotifyCtrl"
		class="de.berlios.jhelpdesk.web.preferences.NotifyEditController">
        <property name="commandName">
            <value>preferences</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.EventNotifyForm</value>
        </property>
        <property name="formView">
            <value>preferences/eventNotify</value>
        </property>
        <property name="successView">
            <value>preferences/eventNotify</value>
        </property>
    </bean>
	
    <bean
		id="preferencesPersonalDataCtrl"
		class="de.berlios.jhelpdesk.web.preferences.PersonalDataEditController">
        <property name="commandName">
            <value>preferences</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.web.form.PersonalDataForm</value>
        </property>
        <property name="formView">
            <value>preferences/personalData</value>
        </property>
        <property name="successView">
            <value>preferences/personalData</value>
        </property>
    </bean>
	<!-- end preferences -->

    <bean id="managerUserEditCtrl" class="de.berlios.jhelpdesk.web.manager.users.EditUserController">
        <property name="commandName">
            <value>user</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.model.User</value>
        </property>
        <property name="formView">
            <value>manager/users/edit</value>
        </property>
        <property name="successView">
            <value>manager/users/show</value>
        </property>
    </bean>

    <bean id="managerBugCategoryShowAllCtrl"
        class="de.berlios.jhelpdesk.web.manager.bugcategory.ShowAllController"/>
	
    <bean id="managerBugCategoryShowOneCtrl"
        class="de.berlios.jhelpdesk.web.manager.bugcategory.ShowCategoryController"/>
	
    <bean id="managerBugCategoryEditCtrl" class="de.berlios.jhelpdesk.web.manager.bugcategory.EditCategoryController">
        <property name="commandName">
            <value>category</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.model.BugCategory</value>
        </property>
        <property name="formView">
            <value>manager/category/edit</value>
        </property>
        <property name="successView">
            <value>manager/category/showAll</value>
        </property>
    </bean>

    <bean
		id="managerBugCategoryUpDownCtrl"
		class="de.berlios.jhelpdesk.web.manager.bugcategory.MoveUpDownCategoryController">
        <property name="methodNameResolver">
            <ref bean="managerBugCategoryUpDownCtrlResolver"/>
        </property>
    </bean>
	
    <bean
		id="managerBugCategoryUpDownCtrlResolver"
		class="org.springframework.web.servlet.mvc.multiaction.PropertiesMethodNameResolver">
        <property name="mappings">
            <props>
                <prop key="/manage/category/up.html">moveUp</prop>
                <prop key="/manage/category/down.html">moveDown</prop>
            </props>
        </property>
    </bean>

	<!-- zarzadzanie sekcjami w bazie wiedzy -->
    <bean
		id="managerKnowledgeSectionEditCtrl"
		class="de.berlios.jhelpdesk.web.manager.knowledge.section.EditSectionController">
        <property name="commandName">
            <value>section</value>
        </property>
        <property name="commandClass">
            <value>de.berlios.jhelpdesk.model.KnowledgeSection</value>
        </property>
        <property name="formView">
            <value>manager/knowledge/section/edit</value>
        </property>
    </bean>

    <bean
		id="managerKnowledgeSectionUpDownCtrl"
		class="de.berlios.jhelpdesk.web.manager.knowledge.section.MoveUpDownSectionController">
        <property name="methodNameResolver">
            <ref bean="managerKnowledgeSectionUpDownCtrlResolver"/>
        </property>
    </bean>
	
    <bean
		id="managerKnowledgeSectionUpDownCtrlResolver" 
		class="org.springframework.web.servlet.mvc.multiaction.PropertiesMethodNameResolver">
        <property name="mappings">
            <props>
                <prop key="/manage/knowledge/section/up.html">moveUp</prop>
                <prop key="/manage/knowledge/section/down.html">moveDown</prop>
            </props>
        </property>
    </bean>
		
    <!--  inne beany widoku -->
    <bean
		id="messageSource"
		class="org.springframework.context.support.ResourceBundleMessageSource">
        <property name="basename">
            <value>message</value>
        </property>
    </bean>

    <bean
		id="tilesConfigurator"
        class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
        <property name="preparerFactoryClass"
			value="org.springframework.web.servlet.view.tiles2.SpringBeanPreparerFactory" />
        <property name="definitions">
            <value>/WEB-INF/tiles-config.xml</value>
        </property>
    </bean>
	
    <bean id="jspViewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
        <property name="viewClass">
            <value>org.springframework.web.servlet.view.tiles2.TilesView</value>
        </property>
        <property name="requestContextAttribute">
            <value>rc</value>
        </property>
    </bean>
	
    <bean
		id="pdfViewResolver" 
		class="org.springframework.web.servlet.view.XmlViewResolver">
        <property name="order">
            <value>1</value>
        </property>
        <property name="location" value="/WEB-INF/views.xml"/>
    </bean>
	
    <bean
		id="multipartResolver"
        class="org.springframework.web.multipart.commons.CommonsMultipartResolver"
	/>

    <!-- mapowanie kontrolerów -->
    <import resource="helpdesk-mapping.xml" />

</beans>